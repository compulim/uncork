# uncork

SSH-over-HTTPS proxy that works like Unix `corkscrew`.

# Install

Run `npm install uncork -g` to install `uncork` globally.

# Run

> Before running `uncork`, make sure your proxy is set in environment variable as either `HTTPS_PROXY` or `HTTP_PROXY`.

Run `uncork 22 ssh.github.com:443` to start `uncork` server on port 22 and forward to [ssh.github.com:443](ssh://ssh.github.com:443).

```
SSH-over-HTTPS proxy 1.0.0

- Listening on port 22
- Will connect to HTTPS proxy at 127.0.0.1:8890
- Will tunnel traffic to destination at ssh.github.com:443
```

If your proxy server requires authentication, you can run `uncork 22 ssh.github.com:443 johndoe P@ssw0rd` to start `uncork` server with proxy authentication.

## Options via environment variables

You can also set options thru environment variables.

| Environment variable  | Description                             | Default              |
| --------------------- | --------------------------------------- | -------------------- |
| uncork_destination    | Destination hostname and port           | `ssh.github.com:443` |
| uncork_port           | Port number to listen to                | `22`                 |
| uncork_proxy_username | Username for proxy BASIC authentication | unset                |
| uncork_proxy_password | Password for proxy BASIC authentication | unset                |

# How we use `uncork`

At our customer site, their Windows boxes are locked behind firewall with HTTPS proxy. We want to use Git client to read/write to GitHub via SSH (using SSH deploy keys to limit the access).

GitHub has a SSH server setup on port 443 instead of 22, described in this [article](https://help.github.com/articles/using-ssh-over-the-https-port/).

Assume our repository is setup with SSH deploy generated by `puttygen`.

On the Windows box:

* Install [PuTTY suite](http://www.chiark.greenend.org.uk/~sgtatham/putty/), with `plink` and `pageant`
* Setup environment variable `GIT_SSH` and point to `plink.exe`
  * Run `SETX GIT_SSH <path to plink.exe>`
* Load the deploy key
  * Run `pageant`
* Install and run `uncork`
  * Run `npm install uncork -g`
  * Run `uncork 22 ssh.github.com:443`
* Clone the repository
  * Run `git clone git@localhost/org/reponame.git`

# Contribution

Like us? [Star](https://github.com/compulim/uncork/stargazers) us.

Found a bug? [File](https://github.com/compulim/uncork/issues) us an issue.
